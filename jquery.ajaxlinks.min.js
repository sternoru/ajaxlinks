(function(e){e.fn.ajaxlinks=function(t){var n={load_to:"#content",load_from:null,loader:"<span>Loading...</span>",callback:null,use_sammy:false,prefix:"",smooth_height:true,goto_top:false,fix_forms:true,add_scripts:false,ajaxify_content:false,base_url:"",ignore:".no-al",ignore_paths:""};var r=e.extend(n,t);if(r.ignore!=""){if(typeof r.ignore=="string"){r.ignore=[r.ignore," a, a",r.ignore].join("")}else{var s="";for(i=0,ln=r.ignore.length;i<ln;i++){s=[s,i>0?", ":"",r.ignore[i]," a, a",r.ignore[i]].join("")}r.ignore=s}}var o=function(e){var t="a[href";if(e.substr(0,1)=="*"){if(e.substr(e.length-1,1)=="*"){t=[t,"*="].join("")}else{t=[t,"$="].join("")}}else if(e.substr(e.length-1,1)=="*"){t=[t,"^="].join("")}else{t=[t,"="].join("")}return[t,e.replace(/\*/g,"").replace(/[#;&,.+~':"!^$[\]()=>|\/]/g,"\\$&"),"]"].join("")};if(r.ignore_paths!=null&&r.ignore_paths!=""){if(typeof r.ignore_paths=="string"){r.ignore_paths=o(r.ignore_paths)}else{var s="";for(i=0,ln=r.ignore_paths.length;i<ln;i++){s=[s,i>0?", ":"",o(r.ignore_paths[i])].join("")}r.ignore_paths=s}}r.links=e(this).filter(":not('"+r.ignore+", "+r.ignore_paths+"')");var u="";var a=function(t){if(r.goto_top){window.scrollTo(0,0)}var n={};if(typeof e.sammy=="function"&&r.use_sammy==true){var i=t.split("|");for(var s=0,o=i.length;s<o;s++){var a=i[s].split("=");if(a.length>2){var l=a[1];for(s=2;s<a.length;s++){var l=[l,"=",a[s]].join("")}n[a[0]]=l}else{n[a[0]]=a[1]}}}else{n.path=t}var c=function(e){var t=new Array;while(e.indexOf("<script")>-1||e.indexOf("</script")>-1){var n=e.indexOf("<script");var r=e.indexOf(">",n);var i=e.indexOf("</script",n);var s=e.indexOf(">",i);t.push(e.substring(r+1,i));e=e.substring(0,n)+e.substring(s+1)}return t};var h=function(i,s,o){e(r.load_to).addClass("ajax-loaded");if(r.smooth_height){d.height("auto")}var u=e(this).html();if(r.load_from&&i){if(e(this).find(r.load_from).length>0){u=e(this).find(r.load_from).html();d.html(u)}else{u=i;d.html(u)}}if(r.fix_forms){e('[action="."]').attr("action",t.replace("path=",""))}if(r.add_scripts){var l=new Array,h=i,p=function(e){setTimeout([e,"();"].join(""),100)},v=function(e,t){if(e===t){return true}if(e.length!=t.length){return false}for(key in e){if(e[key]!==t[key]){return false}}return true},m=function(e){a=new Array;for(C=0;C<e.length;C++){if(!g(a,e[C])){a.length+=1;a[a.length-1]=e[C]}}return a},g=function(e,t){for(j=0;j<e.length;j++){if(v(e[j],t)){return true}}return false};while(h.indexOf("<script ")>-1&&h.indexOf("></script>")>-1){var y=h.indexOf("<script ");var b=h.indexOf("</script>",y);if(h.substring(y,b).indexOf("src=")>-1){var w=h.indexOf("src=",y)+5;var E=h.substring(w-1,w);var S=h.indexOf(E,w);var x=h.substring(w,S);if(h.substring(y,b).indexOf("data-callback=")>-1){var T=h.indexOf("data-callback=",y)+15;var E=h.substring(T-1,T);var N=h.indexOf(E,T);var x=[x,h.substring(T,N)]}l.push(x)}h=h.substring(0,y)+h.substring(b+9)}m(l);for(var C=0,k=l.length;C<k;C++){if(typeof l[C]!="string"){var L=l[C][0];var A=l[C][1]}else{var L=l[C];var A=false}if(e(['head script[src*="',L,'"]'].join("")).length==0){e.ajax({url:L,dataType:"script",cache:true,async:false})}else if(A){p(A)}}}if(r.ajaxify_content){f(e(r.load_to).find("a").filter(":not('"+r.ignore+", "+r.ignore_paths+"')"))}if(r.callback){var O=r.links.filter('[href*="'+t+'"]');var l=c(i);r.callback(u,O,n,l)}};u=n.path;var p=r.load_from?[n.path,r.load_from].join(" "):n.path,d=e(r.load_to);if(r.smooth_height){d.height(d.height())}d.html(e(r.loader)).load(p,h)};var f=function(t){var n=function(e){return!(e.indexOf(location.href.replace("http://","").replace("https://","").split("/")[0])>-1)};if(r.use_sammy){t.each(function(t,i){var s=e(i).attr("href");if(s!=undefined&&s.indexOf("#!")==-1&&!n(e(i)[0].href)){e(i).attr("href",[r.base_url,r.prefix,"#!path=",s].join(""))}})}else{t.each(function(t,r){if(!n(e(r)[0].href)){e(r).data("al","true");e(r).bind("click",function(){a(e(this).attr("href"));return false})}})}};if(typeof e.sammy=="function"&&r.use_sammy==true){if(e.sammy.apps==undefined){var l=e.sammy(function(){this.get(/\#!(.*)/,function(e){a(window.location.href.split("#!")[1])})});e(function(){l.run()})}f(r.links)}else{f(r.links)}}})(jQuery)